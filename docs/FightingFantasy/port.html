<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Port of Peril Companion</title>
<link href="https://fonts.googleapis.com/css2?family=MedievalSharp&display=swap" rel="stylesheet">

<style>
  body {
    margin: 0;
    font-family: 'MedievalSharp', cursive;
    background: linear-gradient(to bottom right, #3b0a0a, #2b0036, #0d0d0d);
    color: #f3e6c9;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 1rem;
  }

  h1 {
    color: #f9d65c;
    text-shadow: 2px 2px #000;
    margin: 1rem 0;
  }

  .sheet, .combat {
    background: #f9f4e8;
    color: #3b0a0a;
    border: 3px solid #f9d65c;
    border-radius: 12px;
    padding: 1.5rem;
    width: 90%;
    max-width: 500px;
    margin: 1rem 0;
    box-shadow: 0 0 15px #000;
  }

  h2 {
    margin-top: 0;
    color: #2b0036;
  }

  label { font-weight: bold; }

  input, select {
    font-family: 'MedievalSharp', cursive;
    padding: 0.3rem;
    margin: 0.4rem 0;
    border: 2px solid #f9d65c;
    border-radius: 6px;
  }

  button {
    font-family: 'MedievalSharp', cursive;
    background: #2b0036;
    color: #f9d65c;
    border: none;
    padding: 0.3rem 0.6rem;
    font-size: 0.9rem;
    border-radius: 6px;
    cursor: pointer;
    margin-left: 0.5rem;
  }

  button:hover {
    background: #3b0a0a;
  }
  
  .remove-btn {
    background: none;
    color: #f9d65c;
    border: none;
    padding: 0;
    font-size: 0.9rem;
    border-radius: 6px;
    cursor: pointer;
    margin-left: 0.5rem;
}
.remove-btn:hover {
  background: #2b0036; 
  color: #ff5555;
}

  ul { padding-left: 1.2rem; }
  li { margin-bottom: 0.4rem; }
  .kofi-container { margin-top: 3rem; }
</style>
</head>
<body>

<h1>‚öîÔ∏è Port of Peril ‚öîÔ∏è</h1>

<!-- Adventure Sheet -->
<div class="sheet">
  <h2>Adventure Sheet</h2>
  <label>
  Skill: <input type="number" id="skill" value="10">
  <span id="init-skill">(Initial: 10)</span>
</label><br>
<label>
  Stamina: <input type="number" id="stamina" value="20">
  <span id="init-stamina">(Initial: 20)</span>
</label><br>
<label>
  Luck: <input type="number" id="luck" value="10">
  <span id="init-luck">(Initial: 10)</span>
</label><br>
  <label>Page: <input type="number" id="page" value="1"></label><br>
  <label>Gold: <input type="number" id="gold" value="0"></label><br>
  
  <h3>Inventory</h3>
  <ul id="inventoryList"></ul>

  <!-- Dropdown for known items -->
  <select id="itemSelect">
    <option value="">-- Select Item --</option>
  </select>
  <button onclick="addSelectedItem()">‚ûï Add</button>
  <br>

  <!-- Input for custom items -->
  <input type="text" id="newItem" placeholder="Add custom item...">
  <button onclick="addNewItem()">‚ûï Add</button>
</div>

<!-- Combat Tracker -->
<div class="combat">
  <h2>Combat Tracker</h2>
  <label>Enemy Name: <input type="text" id="enemyName" placeholder="Goblin"></label><br>
  <label>Enemy Skill: <input type="number" id="enemySkill" value="6"></label><br>
  <label>Enemy Stamina: <input type="number" id="enemyStamina" value="6"></label><br>

  <button onclick="fightRound()">Fight Round</button>
  <p id="combatLog"></p>
</div>

<a href="library.html" style="color:#f9d65c; text-decoration:none; font-weight:bold;">‚¨Ö Back to Books</a>

<div class="kofi-container">
  <script src="https://storage.ko-fi.com/cdn/widget/Widget_2.js"></script>
  <script>
    kofiwidget2.init('Support me on Ko-fi', '#72a4f2', 'X8X818RDQ3');
    kofiwidget2.draw();
  </script>
</div>

<footer style="margin-top:auto; padding:1rem; font-size:0.8rem; color:#7a562c;">
Made with ‚öîÔ∏è &amp; üêâ by SnarfM TransformingPanda
</footer>

<script>
  let initialStats = {
  skill: 10,
  stamina: 20,
  luck: 10
};

// --- Items and Buffs ---
const items = [
  { name: "Sword", buffs: {} },
  { name: "Leather Armor" },
  { name: "Shield" },
  { name: "Potion of Fortune", effect: "Restores Luck to Initial +1" },
  { name: "Map" },
  { name: "Demon Dagger", buffs: { Sk: +1 } },
  { name: "Bracelet of Power", buffs: { Sk: +1, St: +2 } },
  { name: "Chain-mail", buffs: { Sk: +1 } },
  { name: "Dwarf Shield", buffs: { Sk: +1 } },
  { name: "Elven Boots", buffs: { Sk: +1, Lu: +1 } },
  { name: "Tyche Ring", buffs: { Lu: +2 } },
  { name: "Rune Ring", buffs: { St: +2 } },
  { name: "Lucky Bones", buffs: { Lu: +2 } },
  { name: "Helmet", buffs: { Sk: +1, Lu: +1 } },
  { name: "Venom Sword", buffs: { At: +3 } },
  { name: "Gauntlets", buffs: { Sk: +1 } },
  { name: "Dragonfly Pendant", buffs: { Sk: +2, St: +2 } },
];

// Starting items
const startingItems = ["Sword", "Leather Armor", "Shield", "Potion of Fortune", "Map"];

// Populate dropdown
function populateDropdown() {
  const select = document.getElementById("itemSelect");
  items.forEach(it => {
    const opt = document.createElement("option");
    opt.value = it.name;
    opt.textContent = it.name;
    select.appendChild(opt);
  });
}

function addInventoryItem(itemName) {
  const li = document.createElement("li");
  li.textContent = itemName;
  const removeBtn = document.createElement("button");
  removeBtn.textContent = "‚ùå";
  removeBtn.classList.add("remove-btn");
  removeBtn.onclick = () => { li.remove(); applyItemBuffs(); };
  li.appendChild(removeBtn);
  document.getElementById("inventoryList").appendChild(li);
  applyItemBuffs();
}

function addSelectedItem() {
  const select = document.getElementById("itemSelect");
  if (select.value) {
    addInventoryItem(select.value);
    select.value = "";
  }
}

function addNewItem() {
  const newItem = document.getElementById("newItem").value.trim();
  if (newItem) {
    addInventoryItem(newItem);
    document.getElementById("newItem").value = "";
  }
}

// --- Buff Application ---
function applyItemBuffs() {
  let baseSkill = 10;
  let baseStam = 20;
  let baseLuck = 10;

  let totalSkill = baseSkill;
  let totalStam = baseStam;
  let totalLuck = baseLuck;

  const inv = Array.from(document.querySelectorAll("#inventoryList li")).map(li => li.firstChild.textContent);
  inv.forEach(itemName => {
    const item = items.find(i => i.name === itemName);
    if (item && item.buffs) {
      if (item.buffs.Sk) totalSkill += item.buffs.Sk;
      if (item.buffs.St) totalStam += item.buffs.St;
      if (item.buffs.Lu) totalLuck += item.buffs.Lu;
    }
  });

  document.getElementById("skill").value = totalSkill;
  document.getElementById("stamina").value = totalStam;
  document.getElementById("luck").value = totalLuck;
}

// --- Combat ---
function rollDice() {
  return Math.floor(Math.random() * 6) + 1;
}

function fightRound() {
  let playerSkill = parseInt(document.getElementById("skill").value);
  let playerStam = parseInt(document.getElementById("stamina").value);
  let enemySkill = parseInt(document.getElementById("enemySkill").value);
  let enemyStam = parseInt(document.getElementById("enemyStamina").value);
  let enemyName = document.getElementById("enemyName").value || "Enemy";

  if (playerStam <= 0 || enemyStam <= 0) {
    document.getElementById("combatLog").textContent = "Combat is already over!";
    return;
  }

  let playerAttack = playerSkill + rollDice() + rollDice();
  let enemyAttack = enemySkill + rollDice() + rollDice();

  if (playerAttack > enemyAttack) {
    enemyStam -= 2;
    document.getElementById("combatLog").textContent = `You hit the ${enemyName}! Their stamina is now ${enemyStam}.`;
  } else if (enemyAttack > playerAttack) {
    playerStam -= 2;
    document.getElementById("combatLog").textContent = `The ${enemyName} hits you! Your stamina is now ${playerStam}.`;
  } else {
    document.getElementById("combatLog").textContent = "It's a draw this round!";
  }

  document.getElementById("stamina").value = playerStam;
  document.getElementById("enemyStamina").value = enemyStam;
}

// --- Init ---
document.addEventListener("DOMContentLoaded", () => {
  populateDropdown();
  
  if (document.querySelectorAll("#inventoryList li").length === 0) {
    startingItems.forEach(item => addInventoryItem(item));
  }
  
  applyItemBuffs();
  });
</script>

</body>
</html>